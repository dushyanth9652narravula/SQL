
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SET Operators &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '6_Combining_Data/03_SQL_Set_Operators';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SQL Functions" href="../7_SQL_Functions/01_Introduction_to_SQL_Functions.html" />
    <link rel="prev" title="SQL Joins" href="02_SQL_Joins.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../1_Introduction_to_SQL.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../1_Introduction_to_SQL.html">
                    Introduction to SQL
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2_Querying_Data.html">Querying the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_Data_Definition_Language.html">Data Definition Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_Data_Manipulation_Language.html">Data Manipulation Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5_Filtering_Data.html">Filtering Data</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="01_Introduction_to_combining_data.html">Combining Data</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="02_SQL_Joins.html">SQL Joins</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">SET Operators</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../7_SQL_Functions/01_Introduction_to_SQL_Functions.html">SQL Functions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../7_SQL_Functions/02_String_Functions.html">String Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7_SQL_Functions/03_Number_Functions.html">Number Functions</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F6_Combining_Data/03_SQL_Set_Operators.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/6_Combining_Data/03_SQL_Set_Operators.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>SET Operators</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rules-for-using-set-operators">Rules for using Set Operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#union-operator">UNION Operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#union-all-operator">UNION ALL Operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#except-operator">EXCEPT Operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intersect-operator">INTERSECT Operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usecases-of-set-operators">Usecases of Set Operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="set-operators">
<h1>SET Operators<a class="headerlink" href="#set-operators" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<ul>
<li><p>Set Operators is anothor mechanism in sql which is used to combine the data. Set Operators combines data row by row which means they appends each row of second table to the first table.</p></li>
<li><p>Basic syntax of the set operators are :</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span>
<span class="n">col1</span><span class="p">,</span>
<span class="n">col2</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">table1</span>

<span class="k">SET</span><span class="w"> </span><span class="k">OPERATOR</span>

<span class="k">SELECT</span>
<span class="n">col1</span><span class="p">,</span>
<span class="n">col2</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">table2</span>
</pre></div>
</div>
</li>
<li><p>So basically the syntax would be</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">QUREY</span><span class="w"> </span><span class="mi">1</span>

<span class="k">SET</span><span class="w"> </span><span class="k">OPERATOR</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="mi">2</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="rules-for-using-set-operators">
<h2>Rules for using Set Operators<a class="headerlink" href="#rules-for-using-set-operators" title="Link to this heading">#</a></h2>
<ul>
<li><p>There are some rules which we need to follow when we are using set operators. Those are:</p>
<ol class="arabic simple">
<li><p>SET Operator can be used almost in all clauses such as WHERE, JOIN, GROUP BY, HAVING etc. But ORDER BY clause must be used at end of second SELECT query only. This means we can use all other clauses such as WHERE, JOIN, GROUP BY, HAVING in both SELECT Queires but we need use ORDER BY clause only once which is at the end of second SELECT query only.</p></li>
<li><p>The number of columns in each query must be same which means if you are selecting only two columns in first SELECT query then you need to select only two columns in the second SELECT query.</p></li>
<li><p>Data types of columns in each query must match or compatible. This means if you are selecting two columns in both queries then data type of column1 in query1 must be same as data type of column1 in query2. Similary for column2 also.</p></li>
<li><p>The order of columns in each query must be same. This rule is same as rule3 which means if column1 in query1 is varchar then column1 in query2 must be varchar. This automatically implies the order is same.</p></li>
<li><p>The column names in the result set are determined by column names specified in the first query. This means first query has control on the result. Suppose if you are selecting 2 columns in both queries then sql decides data types of result set based on the data types of the 2 columns in first query. If column1 data type in first query is integer then column1 of second query is must be integer. If not sql tries to convert the data type of column1 if second query into integer. If it fails to convert then sql throws an error. This means first query controls the resultant set. So column names of resultant set is same as column names or aliases mentioned in first SELECT query only. Eventhough you mention any aliases on second query then sql doesn’t consider them.</p></li>
<li><p>Even if you met all the rules and sql shows no errors the result may be incorrect. Because incorrect column selection might leads to inaccurate results. For example, if you select first_name, last_name in first sql query and last_name , first_name in second sql query then the result would be incorrect as you changed the order in second query. Eventhough this query met all the above rules but the result would be incorrect as some of the firstnames are lastnames and some of the lastnames are firstnames.</p></li>
</ol>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
<span class="n">firstname</span><span class="p">,</span>
<span class="n">lastname</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">sales</span><span class="p">.</span><span class="n">customers</span>

<span class="k">UNION</span>

<span class="k">SELECT</span>
<span class="n">lastname</span><span class="p">,</span>
<span class="n">firstname</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">sales</span><span class="p">.</span><span class="n">employees</span>
</pre></div>
</div>
</li>
<li><p>Now lets see the set operators that sql provides to combines tables row by row.</p></li>
</ul>
</section>
<section id="union-operator">
<h2>UNION Operator<a class="headerlink" href="#union-operator" title="Link to this heading">#</a></h2>
<ul>
<li><p>UNION Operator returns all distinct rows from both queries which means it combines all rows of both tables and removes duplicate rows from the result.</p></li>
<li><p>The basic syntax of UNION Operator is :</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="mi">1</span>

<span class="k">UNION</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="mi">2</span>
</pre></div>
</div>
</li>
<li><p><strong>Ex</strong> : Combine the data from employees and customers into one table from salesdb.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span>
<span class="n">firstname</span><span class="p">,</span>
<span class="n">lastname</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="p">.</span><span class="n">Employees</span>

<span class="k">UNION</span>

<span class="k">SELECT</span>
<span class="n">firstname</span><span class="p">,</span>
<span class="n">lastname</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="p">.</span><span class="n">Customers</span>
</pre></div>
</div>
</li>
<li><p><strong>Working of UNION</strong> : SQL first extracts the column names from the first SELECT query such as firstname and lastname then it removes any duplicates present in table1 and then it adds those distinct rows from the table1 to resultant. Now it checks rows in table2 to decide whether any of the rows present in resultant or not. If that rows are not present in resultant then sql appends those rows to resultant set.</p></li>
</ul>
</section>
<section id="union-all-operator">
<h2>UNION ALL Operator<a class="headerlink" href="#union-all-operator" title="Link to this heading">#</a></h2>
<ul>
<li><p>UNION ALL returns all the rows from the both queries, including duplicates. UNION ALL is faster than UNION operator as it doesn’t perform any other operations like removing duplicates etc. So if you know your tables doesn’t contain any duplicates and you want to combine the two tables then use UNION ALL instead of UNION as it is faster. If you want to check whether there are any duplicates present in the resultant table then we can use UNION ALL Operator.</p></li>
<li><p>Basic Syntax of UNION ALL is :</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="mi">1</span>

<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="mi">2</span>
</pre></div>
</div>
</li>
<li><p><strong>Ex</strong> : Combine the data from customers and employees into one table including the duplicates.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
<span class="n">firstname</span><span class="p">,</span>
<span class="n">lastname</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="p">.</span><span class="n">Customers</span>

<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span>

<span class="k">SELECT</span>
<span class="n">firstname</span><span class="p">,</span>
<span class="n">lastname</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="p">.</span><span class="n">Employees</span>
</pre></div>
</div>
</li>
<li><p><strong>Working of UNION ALL</strong> : In case of UNION ALL, SQL first extracts the column names from the first SELECT Query then it extracts all the rows from the table1 and append it to result set then it extracts all the rows from table2 and it appends those rows to the result set.</p></li>
</ul>
</section>
<section id="except-operator">
<h2>EXCEPT Operator<a class="headerlink" href="#except-operator" title="Link to this heading">#</a></h2>
<ul>
<li><p>EXCEPT Operator returns the all unique rows from first table or query which are not present in second table or query. When we are using EXCEPT Operator Order of the tables or queries matters as it effects the final result.</p></li>
<li><p>Basic Syntax of EXCEPT is :</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="mi">1</span>

<span class="k">EXCEPT</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="mi">2</span>
</pre></div>
</div>
</li>
<li><p><strong>Ex</strong> : Find the customers who are not employees.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span>
<span class="n">firstname</span><span class="p">,</span>
<span class="n">lastname</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="p">.</span><span class="n">Customers</span>

<span class="k">EXCEPT</span>

<span class="k">SELECT</span>
<span class="n">firstname</span><span class="p">,</span>
<span class="n">lastname</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="p">.</span><span class="n">Employees</span>
</pre></div>
</div>
</li>
<li><p><strong>Working of EXCEPT</strong> :  In Case of EXCEPT, SQL first extracts the column names from first query such as firstname, lastname here. Now it checks each row in query1 (or table1) with each row in table2. If that row from table1 is not present in the table2 then it appends that row to the result set. So in case of EXCEPT, SQL uses second query as lookup table. This is how it extracts rows from query1 which are not present in query2.</p></li>
</ul>
</section>
<section id="intersect-operator">
<h2>INTERSECT Operator<a class="headerlink" href="#intersect-operator" title="Link to this heading">#</a></h2>
<ul>
<li><p>INTERSECT Operator returns the rows which are common in both the queries. This means it returns the common rows from both the tables and excludes all other rows from the both tables. Here Order of queires doesn’t matter.</p></li>
<li><p>Basic Syntax is :</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="mi">1</span>

<span class="k">INTERSECT</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="mi">2</span>
</pre></div>
</div>
</li>
<li><p><strong>Ex</strong> : Find the customers who are also employees.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span>
<span class="n">firstname</span><span class="p">,</span>
<span class="n">lastname</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="p">.</span><span class="n">Customers</span>

<span class="k">INTERSECT</span>

<span class="k">SELECT</span>
<span class="n">firstname</span><span class="p">,</span>
<span class="n">lastname</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="p">.</span><span class="n">Employees</span>
</pre></div>
</div>
</li>
<li><p><strong>Working of INTERSECT</strong> : SQL first extracts column names from first query and then starts checking the rows in table1 with rows in table2 to know whether any row is common between two tables. If it finds any common row then it apends it to the result set. Like this it scans entire tables.</p></li>
</ul>
</section>
<section id="usecases-of-set-operators">
<h2>Usecases of Set Operators<a class="headerlink" href="#usecases-of-set-operators" title="Link to this heading">#</a></h2>
<ul>
<li><p>Set Operators like UNION, UNION ALL are used to combine similar data before analyzing the data. Suppose if you have tables such as Customers, Employees, Suppliers, Students etc and you want perform some analysis on these tables and generate reports. Generally they will write seperate queires for each table and include results of these queries in that report. Since they contain similar data such as firstname, lastname, country, gender, address etc, we can combine all these data into one data and make it as person table and then we can write single query to perform analysis and include those results in that report. This way generate more consistent results as we are writing 4 queries for 4 table and if you make changes to two queries and forgot to change the other two queries then we might see inconsistent results. So combining all data into one mega table would be better choice for analysis part.</p></li>
<li><p>Generally, Database developers divide the data into multiple table to optimize the performance and archive old data. So many organizations use seperate tables to store the order data for each year. Because, they want to archive thier older data for furture analysis. I mean some analytics need only current year data and some analytics need entire data. So to improve the performance they seperate data like this. So when we are performing analytics on entire order data then its better to combine all the order data using UNION or UNION ALL operator.</p></li>
<li><p>For example we have current year order data as orders and older order data as orderarchive. To combine this we use this query.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
<span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="p">.</span><span class="n">Orders</span>

<span class="k">UNION</span>

<span class="k">SELECT</span>
<span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="p">.</span><span class="n">OrderArchive</span>
</pre></div>
</div>
</li>
<li><p>Since we know both orders and orderarchive have same schema we have used <code class="docutils literal notranslate"><span class="pre">*</span></code> instead of mentioning all the columns in the query. But its not best way to do it. Suppose , for coming year by mistake they kept productId at first and then orderID as second column, then when you try to combine the older table with newer order table then you get incorrect results by mixing order and product Ids. So its better to mention all the column names in the both queries instead of <code class="docutils literal notranslate"><span class="pre">*</span></code> symbol.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span>
<span class="s1">&#39;Orders&#39;</span><span class="w"> </span><span class="k">As</span><span class="w"> </span><span class="n">SourceTable</span><span class="p">,</span>
<span class="p">[</span><span class="n">OrderID</span><span class="p">],</span>
<span class="p">[</span><span class="n">ProductID</span><span class="p">],</span>
<span class="p">[</span><span class="n">CustomerID</span><span class="p">],</span>
<span class="p">[</span><span class="n">SalesPersonID</span><span class="p">],</span>
<span class="p">[</span><span class="n">OrderDate</span><span class="p">],</span>
<span class="p">[</span><span class="n">ShipDate</span><span class="p">],</span>
<span class="p">[</span><span class="n">OrderStatus</span><span class="p">],</span>
<span class="p">[</span><span class="n">ShipAddress</span><span class="p">],</span>
<span class="p">[</span><span class="n">BillAddress</span><span class="p">],</span>
<span class="p">[</span><span class="n">Quantity</span><span class="p">],</span>
<span class="p">[</span><span class="n">Sales</span><span class="p">],</span>
<span class="p">[</span><span class="n">CreationTime</span><span class="p">]</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="p">.</span><span class="n">Orders</span>

<span class="k">UNION</span>

<span class="k">SELECT</span>
<span class="s1">&#39;OrdersArchive&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">SourceTable</span><span class="p">,</span>
<span class="p">[</span><span class="n">OrderID</span><span class="p">],</span>
<span class="p">[</span><span class="n">ProductID</span><span class="p">],</span>
<span class="p">[</span><span class="n">CustomerID</span><span class="p">],</span>
<span class="p">[</span><span class="n">SalesPersonID</span><span class="p">],</span>
<span class="p">[</span><span class="n">OrderDate</span><span class="p">],</span>
<span class="p">[</span><span class="n">ShipDate</span><span class="p">],</span>
<span class="p">[</span><span class="n">OrderStatus</span><span class="p">],</span>
<span class="p">[</span><span class="n">ShipAddress</span><span class="p">],</span>
<span class="p">[</span><span class="n">BillAddress</span><span class="p">],</span>
<span class="p">[</span><span class="n">Quantity</span><span class="p">],</span>
<span class="p">[</span><span class="n">Sales</span><span class="p">],</span>
<span class="p">[</span><span class="n">CreationTime</span><span class="p">]</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="p">.</span><span class="n">OrdersArchive</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">OrderID</span>
</pre></div>
</div>
</li>
<li><p>So by mentioning the column names we might know that we need to change the order of columns (change the order of ProductID and OrderID) while combining the new table with old table. And one more thing, its better to add new column such as sourcetable to know from which table this column has came from. These are the usecases of UNION and UNION ALL.</p></li>
<li><p>SET Operators such as EXCEPT is used majorly in DELTA detection. Delta detection is nothing but identifying the changes between two batches of data. Suppose you are shifting data from source systems to data warehouse. On day 1 , you shifted data of john doe and jan doe data from source systems to data warehouse. Now on day 2 you got john doe and alice data in source system. But we have already sent john doe data to data warehouse. So we have to send only alice data to data warehouse today. So what we actually do is we perform EXCEPT Operation on day 2 and day 1 data, so that we get only unique data from day2 which are not present in day1. Then we can add these unique data to data warehouse.</p></li>
<li><p>This EXCEPT operated might be used in case of data migration. Some times organizations migrates data from Database1 to Database2 for backups and any other usecases. So in these case they have migrate all the data from Database1 to Database2 so that both databases should be identical. To check all data gets migrated from Database1 to Database2 then perform EXCEPT operation on Database1 and Database2. This will give unique rows from Database1 which are not present on Database2. If it gives empty set then we can tell all the data present in Database1 is migrated to Database2. Now we need to perform reverse operation also which means we need perform EXCEPT Operation on Database2 and Database1 so that we get unique rows from Database2 that are not present in Database1. If we get any rows they we can say that new rows are added to Database2. So they can delete those new rows from Database2 to make both Databases identical. If we get empty set then we can say both databases are identical.</p></li>
<li><p>These is how SET Operators are used in real world use cases.</p></li>
</ul>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Set Operators are used to combine the tables row by row into a single resultant set. We have 4 major set operators those are UNION, UNION ALL, EXCEPT, INTERSECT.</p></li>
<li><p>UNION is used to return all the rows from the both tables by removing the duplicates from them. UNION ALL returns all the rows from both the tables including the duplicates.</p></li>
<li><p>EXCEPT returns the unique rows from the first query or table which are not found in second query or table. INTERSECT returns the common rows between both tables.</p></li>
<li><p>Major rules of SET Operators are same no of columns, data types, order of columns and column names or aliases are determined by the first query only.</p></li>
<li><p>Major use cases are Combine Similar Data (UNION or UNION ALL), DELTA Detection (EXCEPT) and Data Completeness check or Data Migration (EXCEPT).</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./6_Combining_Data"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="02_SQL_Joins.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">SQL Joins</p>
      </div>
    </a>
    <a class="right-next"
       href="../7_SQL_Functions/01_Introduction_to_SQL_Functions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">SQL Functions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rules-for-using-set-operators">Rules for using Set Operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#union-operator">UNION Operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#union-all-operator">UNION ALL Operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#except-operator">EXCEPT Operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intersect-operator">INTERSECT Operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usecases-of-set-operators">Usecases of Set Operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>